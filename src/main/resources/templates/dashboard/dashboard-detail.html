<!-- resources/dashboard/dashboard-detail.html-->

<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
    <title>1번 서버 IoT 센서 데이터</title>

    <th:block layout:fragment="css">
        <!-- 이 페이지에만 필요한 추가 CSS -->
        <style>
            .dashboard-card {
                border-radius: 1rem; /* 카드 모서리 둥글게 */
                box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1); /* 부드러운 그림자 */
                overflow: hidden; /* 내부 차트가 카드를 벗어나지 않도록 */
            }

            .dashboard-card .card-header {
                background-color: transparent;
                border-bottom: none;
                padding-top: 1rem;
                padding-bottom: 0;
                font-size: 0.9rem;
                color: #6c757d; /* 부제목 색상 */
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .dashboard-card .card-header .card-title-text {
                font-weight: 600;
            }

            .dashboard-card .card-body {
                padding: 1rem;
                display: flex;
                flex-direction: column;
                align-items: center; /* 게이지 차트 중앙 정렬 */
            }

            .gauge-chart-container {
                width: 150px; /* 게이지 차트 너비 고정 */
                height: 100px; /* 게이지 차트 높이 고정 */
                margin-bottom: 0.5rem;
            }

            .gauge-value-text {
                font-size: 1.8rem;
                font-weight: bold;
                color: #343a40; /* 주요 값 색상 */
            }
            .gauge-sub-text {
                font-size: 0.8rem;
                color: #6c757d;
                margin-top: -0.25rem;
            }
            .gauge-status-text {
                font-size: 0.75rem;
                color: #6c757d;
                margin-top: 0.25rem;
            }

            .mini-timeseries-chart-container {
                width: 100%;
                height: 150px; /* 작은 시계열 차트 높이 */
                margin-top: 1rem;
                border-radius: 0.75rem; /* 내부 차트 컨테이너도 둥글게 */
                padding: 1rem;
                position: relative; /* 내부 제목 절대 위치용 */
            }

            .mini-timeseries-chart-container .chart-title-overlay {
                position: absolute;
                top: 1rem;
                left: 1rem;
                font-size: 1.1rem;
                font-weight: bold;
                color: white; /* 기본 흰색, 배경색에 따라 조정 필요 */
                z-index: 10;
            }
            .mini-timeseries-chart-container .chart-current-value-overlay {
                position: absolute;
                top: 1rem;
                right: 1rem; /* 오른쪽 상단 */
                font-size: 0.9rem;
                color: white;
                background-color: rgba(0,0,0,0.2);
                padding: 0.25rem 0.5rem;
                border-radius: 0.25rem;
                z-index: 10;
            }

            /* 각 카드별 배경색 및 텍스트 색상 (이미지 참고) */
            .card-memory { background: linear-gradient(135deg, #23bdb8 0%, #43e97b 100%); } /* 청록-초록 */
            .card-diskio { background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%); } /* 하늘-파랑 */
            .card-network { background: linear-gradient(135deg, #ff8c42 0%, #ff3f89 100%); } /* 주황-핑크 */
            .card-cpu { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); } /* 노랑-주황 */

            /* 시계열 차트 내부의 제목/값 오버레이를 위한 공통 스타일 */
            .card-memory .chart-title-overlay, .card-memory .chart-current-value-overlay,
            .card-diskio .chart-title-overlay, .card-diskio .chart-current-value-overlay,
            .card-network .chart-title-overlay, .card-network .chart-current-value-overlay,
            .card-cpu .chart-title-overlay, .card-cpu .chart-current-value-overlay {
                color: white; /* 기본 흰색, 필요시 각 카드별로 조정 가능 */
            }
            .main-title-area {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1.5rem;
            }
            .server-select-buttons .btn {
                margin-left: 0.5rem;
                border-radius: 20px; /* 버튼 둥글게 */
                font-size: 0.85rem;
            }
            .time-range-buttons .btn {
                margin-left: 0.5rem;
                font-size: 0.8rem;
                padding: 0.25rem 0.75rem;
                border-radius: 15px;
            }
            .time-range-buttons .btn.active {
                background-color: #0d6efd; /* 활성 버튼 색상 (부트스트랩 primary) */
                color: white;
            }
            .card-options-button {
                color: #6c757d;
                background: none;
                border: none;
            }
        </style>
    </th:block>
    <script type="module" src="/admin/js/iotSensorApi.js"></script>
    <script type="module" src="/admin/js/dashboard.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script type="module" src="/admin/js/scripts.js"></script>
</head>

<body>
<div layout:fragment="content">
    <div class="row">
        <!-- 현재 메모리 사용량 (게이지) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card">
                <div class="card-header">
                    <span class="card-title-text">현재 메모리 사용량</span>
                    <button class="card-options-button"><i class="fas fa-ellipsis-v"></i></button>
                </div>
                <div class="card-body">
                    <div class="gauge-chart-container">
                        <canvas id="memoryGauge"></canvas>
                    </div>
                    <div id="memoryValueText" class="gauge-value-text">--</div> <!-- 값 (예: 104 8mb) -->
                    <div class="gauge-status-text">정상입니다.</div>
                </div>
            </div>
        </div>

        <!-- 메모리 사용량 (시계열) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card card-memory">
                <div class="card-header d-flex justify-content-end time-range-buttons">
                    <button type="button" class="btn btn-light btn-sm active" data-range="1day">1 day</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1week">1 week</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1month">1 month</button>
                </div>
                <div class="card-body mini-timeseries-chart-container">
                    <div class="chart-title-overlay">메모리 사용량</div>
                    <div id="memoryCurrentValueOverlay" class="chart-current-value-overlay">-- GB</div>
                    <canvas id="memoryTimeseriesChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 현재 디스크 I/O 속도 (게이지) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card">
                <div class="card-header">
                    <span class="card-title-text">현재 디스크/IO속도</span>
                    <button class="card-options-button"><i class="fas fa-ellipsis-v"></i></button>
                </div>
                <div class="card-body">
                    <div class="gauge-chart-container">
                        <canvas id="diskIoGauge"></canvas>
                    </div>
                    <div id="diskIoValueText" class="gauge-value-text">--</div> <!-- 값 (예: 120) -->
                    <div class="gauge-status-text">정상입니다.</div>
                </div>
            </div>
        </div>

        <!-- 디스크 I/O 속도 (시계열) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card card-diskio">
                <div class="card-header d-flex justify-content-end time-range-buttons">
                    <button type="button" class="btn btn-light btn-sm active" data-range="1day">1 day</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1week">1 week</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1month">1 month</button>
                </div>
                <div class="card-body mini-timeseries-chart-container">
                    <div class="chart-title-overlay">디스크 I/O 속도</div>
                    <div id="diskIoCurrentValueOverlay" class="chart-current-value-overlay">-- MB/s</div>
                    <canvas id="diskIoTimeseriesChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- 현재 네트워크 트래픽 (게이지) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card">
                <div class="card-header">
                    <span class="card-title-text">현재 네트워크 트래픽</span>
                    <button class="card-options-button"><i class="fas fa-ellipsis-v"></i></button>
                </div>
                <div class="card-body">
                    <div class="gauge-chart-container">
                        <canvas id="networkTrafficGauge"></canvas>
                    </div>
                    <div id="networkTrafficValueText" class="gauge-value-text">--</div> <!-- 값 (예: 350mb) -->
                    <div class="gauge-status-text">평소보다 출입 횟수가 증가함.</div>
                </div>
            </div>
        </div>

        <!-- 네트워크 트래픽 (시계열) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card card-network">
                <div class="card-header d-flex justify-content-end time-range-buttons">
                    <button type="button" class="btn btn-light btn-sm active" data-range="1day">1 day</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1week">1 week</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1month">1 month</button>
                </div>
                <div class="card-body mini-timeseries-chart-container">
                    <div class="chart-title-overlay">네트워크 트래픽</div>
                    <div id="networkCurrentValueOverlay" class="chart-current-value-overlay">-- Mbps</div>
                    <canvas id="networkTimeseriesChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 현재 CPU 사용률 (게이지) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card">
                <div class="card-header">
                    <span class="card-title-text">현재 CPU 사용률</span>
                    <button class="card-options-button"><i class="fas fa-ellipsis-v"></i></button>
                </div>
                <div class="card-body">
                    <div class="gauge-chart-container">
                        <canvas id="cpuUsageGauge"></canvas>
                    </div>
                    <div id="cpuUsageValueText" class="gauge-value-text">--</div> <!-- 값 (예: 45%) -->
                    <div class="gauge-status-text">평소보다 출입 횟수가 증가함.</div>
                </div>
            </div>
        </div>

        <!-- CPU 사용률 (시계열) -->
        <div class="col-xl-3 col-lg-6 mb-4">
            <div class="card dashboard-card card-cpu">
                <div class="card-header d-flex justify-content-end time-range-buttons">
                    <button type="button" class="btn btn-light btn-sm active" data-range="1day">1 day</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1week">1 week</button>
                    <button type="button" class="btn btn-light btn-sm" data-range="1month">1 month</button>
                </div>
                <div class="card-body mini-timeseries-chart-container">
                    <div class="chart-title-overlay">CPU 사용률</div>
                    <div id="cpuCurrentValueOverlay" class="chart-current-value-overlay">-- %</div>
                    <canvas id="cpuTimeseriesChart"></canvas>
                </div>
            </div>
        </div>
    </div>

</div>
</body>
</html>
